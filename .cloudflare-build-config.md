# Cloudflare Pages Build Configuration

## Web Admin Build Settings

**Framework preset:** Vite  
**Build command:**
```bash
cd apps/web-admin && yarn install --frozen-lockfile && yarn build
```

**Build output directory:** `apps/web-admin/dist`

**Root directory:** (leave empty)

**Environment variables:**
```
NODE_VERSION=22.16.0
YARN_VERSION=1.22.22
NPM_FLAGS=--frozen-lockfile
```

---

## Web Student Build Settings

**Framework preset:** Vite  
**Build command:**
```bash
cd apps/web-student && yarn install --frozen-lockfile && yarn build
```

**Build output directory:** `apps/web-student/dist`

**Root directory:** (leave empty)

**Environment variables:**
```
NODE_VERSION=22.16.0
YARN_VERSION=1.22.22
NPM_FLAGS=--frozen-lockfile
```

---

## ⚠️ Important Notes

1. **Yarn Version:** Project uses Yarn v1.22.22 (Classic). The `packageManager` field in root `package.json` ensures Cloudflare uses correct version.

2. **Frozen Lockfile:** Always use `--frozen-lockfile` to prevent lockfile modifications during CI builds.

3. **Monorepo Structure:** Since both apps are in `apps/` folder, build commands must `cd` into the specific app directory first.

4. **Environment Variables:** Add in Cloudflare Dashboard → Project Settings → Environment variables

---

## Troubleshooting

### "Lockfile would have been modified" Error

**Cause:** Cloudflare detected Yarn v4 instead of v1.22.

**Fix:** Add `packageManager: "yarn@1.22.22"` to root `package.json` (already done ✅)

### Build Timeout

**Cause:** Installing all dependencies for monorepo.

**Fix:** Build command already optimized to only install dependencies for specific app.

### Missing Environment Variables

**Cause:** `VITE_API_URL` not set.

**Fix:** Add to Cloudflare environment variables or use `.env.production` file.
