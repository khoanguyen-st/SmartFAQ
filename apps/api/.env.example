# ===================================
# Core Application Settings
# ===================================
APP_ENV=development
API_HOST=0.0.0.0
API_PORT=8000

# ===================================
# Security & Authentication
# ===================================
JWT_SECRET=your-super-secret-jwt-key-change-in-production
JWT_EXPIRE_MINUTES=1440

# Default Admin Account (for initial setup)
ADMIN_DEFAULT_USERNAME=admin
ADMIN_DEFAULT_EMAIL=admin@smartfaq.com
ADMIN_DEFAULT_PASSWORD=changeme123

# ===================================
# Database Configuration
# ===================================
DATABASE_URL=postgresql+psycopg://smartfaq:smartfaq@localhost:5432/smartfaq

# PostgreSQL (for docker-compose)
POSTGRES_USER=smartfaq
POSTGRES_PASSWORD=smartfaq
POSTGRES_DB=smartfaq

# ===================================
# Google Gemini LLM Configuration
# ===================================
# Get your API key from: https://aistudio.google.com/app/apikey
GOOGLE_API_KEY=your-gemini-api-key-here

# Model selection (see: https://ai.google.dev/gemini-api/docs/models)
# Options: gemini-2.5-flash, gemini-1.5-flash, gemini-1.5-pro
LLM_MODEL=gemini-2.5-flash
LLM_TEMPERATURE=0.3
LLM_MAX_TOKENS=2048

# ===================================
# Embeddings Configuration (HuggingFace)
# ===================================
# Using multilingual-e5-base for local embeddings
# Model card: https://huggingface.co/intfloat/multilingual-e5-base
EMBED_MODEL=intfloat/multilingual-e5-base
EMBED_DEVICE=cpu  # Options: cpu, cuda (if GPU available)
EMBED_NORMALIZE=true
EMBED_BATCH=32

# ===================================
# Vector Store (Chroma) Configuration
# ===================================
CHROMA_URL=http://localhost:8001
CHROMA_COLLECTION=kb_main
CHROMA_METRIC=cosine  # Options: cosine, l2, ip
# CHROMA_HEADERS=Authorization: Bearer xxx;X-Tenant: default  # Optional auth

# ===================================
# RAG System Settings
# ===================================
CONFIDENCE_THRESHOLD=0.65
CONFIDENCE_DECAY=0.6  # Decay factor for weighted confidence calculation (0.0-1.0)
MAX_CONTEXT_CHARS=8000
TOP_K_RETRIEVAL=5
SEMANTIC_CHUNK_SIZE_TOKENS=1750
SEMANTIC_CHUNK_OVERLAP_TOKENS=100
SEMANTIC_CHUNK_THRESHOLD=0.6

# Hybrid Search (Vector + BM25 Lexical)
HYBRID_ENABLED=true
HYBRID_K_VEC=20  # Number of results from vector search
HYBRID_K_LEX=20  # Number of results from BM25 search
HYBRID_FUSION_K=60  # RRF fusion parameter
HYBRID_MAX_DOCS=5000  # Max docs to load for BM25 index

# ===================================
# Document Upload Settings
# ===================================
UPLOAD_MAX_MB=50
# ===================================
# Cloud Storage
# ===================================
MINIO_ROOT_USER=smartfaq
MINIO_ROOT_PASSWORD=smartfaq
MINIO_ENDPOINT=http://minio:9000
MINIO_BUCKET=smartfaq-data

# ===================================
# Celery & Redis (Background Tasks)
# ===================================
CELERY_BROKER_URL=redis://localhost:6379/0
CELERY_RESULT_BACKEND=redis://localhost:6379/0

# ===================================
# MongoDB Configuration
# ===================================
MONGO_USERNAME=smartfaq
MONGO_PASSWORD=smartfaq
MONGO_DB=smartfaq
MONGO_PORT_EXTERNAL=27017
MONGO_URL=mongodb://smartfaq:smartfaq@mongo:27017/?authSource=admin
MONGO_CHAT_COLLECTION=chat_messages
MONGO_SESSION_COLLECTION=chat_sessions

# ===================================
# Frontend (Web Admin & Student)
# ===================================
VITE_API_BASE_URL=http://localhost:8000

# ===================================
# Port Mappings
# ===================================
API_PORT_EXTERNAL=8000
WEB_STUDENT_PORT_EXTERNAL=5173
WEB_ADMIN_PORT_EXTERNAL=5174
POSTGRES_PORT_EXTERNAL=5432
REDIS_PORT_EXTERNAL=6379
CHROMA_PORT_EXTERNAL=8001
